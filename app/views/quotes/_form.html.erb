
<%= form_with(model: quote, local: true) do |form| %>
  <% if quote.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(quote.errors.count, "error") %> prohibited this quote from being saved:</h2>

      <ul>
      <% quote.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="submission-quote">

  <div class="field">
    <strong>Customer:</strong>
    <%= form.collection_select :customer_id, Customer.order(:customer_lname), :id, :customer_lname, include_blank: true  %>
  </div>

  <div class="field">
    <strong>Manufacturer:</strong>
    <%= form.select :manufacturer_id,
                    options_for_select(Manufacturer.select_values, quote&.manufacturer&.id),
                    { include_blank: true },
                    { class: 'remote-select', data: { target: '#quote_series_id' }} %>
  </div>

  <div class="field">
    <strong>Series:</strong>
    <%= form.select :series_id,
                    options_for_select(Series.select_values(quote&.manufacturer), quote&.series&.id),
                    {},
                    {} %>
  </div>



  <div class="field", onchange="psycho()">
    <strong>Model:</strong>
    <%= form.collection_select :model_id, Model.order(:model_number),:id,:model_number, include_blank: true, name: 'mod'  %>
  </div>
<%-# the specific equipment will have its foreign key column 'quote_id' filled after a quote with its related model number has been finalized -%>
  <div class="field", onchange="psycho()">
    <strong> Attachment (Optional):</strong>
    <%= form.collection_select :attachment_id, Attachment.order(:attachment_feature),:id, :attachment_feature, include_blank: true  %>
  </div>

  <div class="field", onchange="psycho()">
    <strong>Implement (Optional):</strong>
    <%= form.collection_select :implement_id, Implement.order(:implement_feature),:id, :implement_feature, include_blank: true  %>
  </div>

  <div class="field", onchange="psycho()">
    <strong>Front Replacement Tires (Optional):</strong>
    <%= form.collection_select :tire_replacement_front_id, TireReplacementFront.order(:order_number),:id, :order_number, include_blank: true  %>
  </div>

  <div class="field", onchange="psycho()">
    <strong>Rear Replacement Tires (Optional):</strong>
    <%= form.collection_select :tire_replacement_rear_id, TireReplacementRear.order(:order_number),:id, :order_number, include_blank: true  %>
  </div>


  <div class="field", onmouseover="psycho()">
    <strong>Base Quote Price:</strong>
    <%= form.text_field :base_quote_price, :value => 0.00, :readonly => true  %>
  </div>

  <div class="field">
    <strong>Total Price:</strong>
    <%= form.text_field :total_price, :readonly => true %>
  </div>
  <% #:value => (:form.var => )%>

  <div class="field">
    <strong>Quote Date:</strong>
    <%= form.datetime_select :quote_date %>
  </div>

  <div class="field">
    <strong>Markup Percentage:</strong>
    <%= form.text_field :markup_percentage %>
  </div>

  <div class="field">
    <strong>*Send to Customer for Approval First*Finalize Date:</strong>
    <%= form.datetime_select :finalize_date %>
  </div>

  <div class="field">
    <strong>Was payment received and the transaction finalized?</strong>
    <%= form.check_box :sale_finalized %>
  </div>




  <%# fields_for :quote, @quote.model do |q_fields| %>
    <%#Admin?  : <%= q_fields.text_field :model_number %>
  <%# end %>

<%#@quote.model_id. %>
  <script>
      function psycho() {
          console.log("Called");

          //var nummie = (document.forms[0]['quote_suggested_list_price'].value)( (document.forms[0]['quote_model_id']) = () ).value;
          //if(document.forms[0]['quote_model_id'].value = document.forms[0]['mod'])
          var nummie = 0.00;
          switch (document.forms[0]['quote_model_id'].value) {
            case '1':
                nummie += 5601;
              break;
            case '2':
                nummie += 5118;
              break;
            case '3':
                nummie += 4442;
              break;
            case '4':
                nummie += 5976;
              break;
            case '5':
                nummie += 6459;
              break;
              default:
          }
          switch (document.forms[0]['quote_attachment_id'].value) {
              case '1':
                  nummie += 26;
                  break;
              case '2':
                  nummie += 0;
                  break;
              case '3':
                  nummie += 0;
                  break;
              case '4':
                  nummie += 0;
                  break;
              case '5':
                  nummie += 0;
                  break;
          }

          switch (document.forms[0]['quote_implement_id'].value) {
              case '1':
                  nummie += 0;
                  break;
              case '2':
                  nummie += 0;
                  break;
              case '3':
                  nummie += 0;
                  break;
              case '4':
                  nummie += 0;
                  break;
              case '5':
                  nummie += 0;
                  break;
          }

          switch (document.forms[0]['quote_tire_replacement_front_id'].value) {
              case '1':
                  nummie += 0;
                  break;
              case '2':
                  nummie += 0;
                  break;
              case '3':
                  nummie += 0;
                  break;
              case '4':
                  nummie += 0;
                  break;
              case '5':
                  nummie += 0;
                  break;
          }

          switch (document.forms[0]['quote_tire_replacement_rear_id'].value) {
              case '1':
                  nummie += 0;
                  break;
              case '2':
                  nummie += 0;
                  break;
              case '3':
                  nummie += 0;
                  break;
              case '4':
                  nummie += 0;
                  break;
              case '5':
                  nummie += 0;
                  break;
          }
              //var nummie = ( (document.forms[0]['quote_model_id']) ).value;
          //nummie += document.forms[0]['quote_attachment_id'].value;
          //nummie += document.forms[0]['quote_implement_id'].value;
          //nummie += document.forms[0]['quote_tire_replacement_front_id'].value;
          //nummie += document.forms[0]['quote_tire_replacement_rear_id'].value;
          document.forms[0]['quote_base_quote_price'].value = nummie;
          document.forms[0]['quote_total_price'].value = nummie;


          //document.getElementById('bb').innerHTML = document.forms[0]['quote_model_id'].value
          //    + document.forms[0]['quote_attachment_id'].value +
          //    document.forms[0]['quote_implement_id'].value +
          //    document.forms[0]['quote_tire_replacement_front_id'].value
          //    + document.forms[0]['quote_tire_replacement_rear_id'].selectedIndex.valueOf();

          //price.options[price.selectedIndex].setAttribute("basePrice", (m.toString()));
          //+ a + i + tf + tr
      }
  </script>

  <div class="actions" id="quote-submit">
    <%= form.submit %>
  </div>

  </div>
<% end %>
